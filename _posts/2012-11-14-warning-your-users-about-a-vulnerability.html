---
layout: post
title: Warning your users about a vulnerability
date: 2012-11-14 15:40:18.000000000 +01:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Development
- Security
tags:
- privacy
- security
- vulnerabilities
- Web
meta:
  _edit_last: '3997956'
  tagazine-media: a:7:{s:7:"primary";s:0:"";s:6:"images";a:0:{}s:6:"videos";a:0:{}s:11:"image_count";i:0;s:6:"author";s:7:"3997956";s:7:"blog_id";s:8:"11260360";s:9:"mod_stamp";s:19:"2012-11-14
    15:02:09";}
  _wpas_done_77741: '1'
  _publicize_done_external: a:1:{s:8:"linkedin";a:1:{s:10:"SRxrIwgSA1";b:1;}}
  _wpas_skip_77741: '1'
  reddit: a:2:{s:5:"count";i:0;s:4:"time";i:1434175684;}
  geo_public: '0'
author:
  login: geaaal
  email: geo.couprie@gmail.com
  display_name: GÃ©al
  first_name: ''
  last_name: ''
---
<p>Somebody just told you about a <a title="Sophos vs Tavis Ormandy" href="http://seclists.org/fulldisclosure/2012/Nov/31" target="_blank">vulnerability in your code</a>. Moreover, they published <a title="The most dangerous code in the world" href="https://crypto.stanford.edu/~dabo/pubs/abstracts/ssl-client-bugs.html" target="_blank">a paper</a> about it. Even worse, people have been <a title="CryptoCat was just totally broken yesterday" href="https://twitter.com/ioerror/status/266648847797854209" target="_blank">very vocal</a> about it.<br />
What can you do now? The usual (and natural) reaction is to downplay the vulnerability, and try to keep it confidential. After all, publishing a vuln will make your users unsafe, and it is bad publicity for your project, right?</p>
<p>WRONG!</p>
<p>The best course of action is to communicate a lot. Here's why:</p>
<h2>Communicate with the security researcher</h2>
<p>Yes, I know, we security people tend to be harsh, quickly flagging a vulnerable project as "broken", "dangerous for your customers" or even "<a title="My little pwnies" href="http://pwnies.com/winners/" target="_blank">EPIC FAIL</a>". That is, unfortunately, part of the folklore. But behind that, security researchers are often happy to help you fix the problem, so take advantage of that!</p>
<p>If you try to silence the researcher, you will not get any more bug reports, but your software will still be vulnerable. Worse, someone else will undoubtedly find the vulnerability, and may sell it to governments and/or criminals.</p>
<p>Vulnerabilities are inevitable, like bugs. Even if you're very careful, <a title="QMail vulnerabilities" href="http://www.cvedetails.com/vulnerability-list/vendor_id-86/product_id-143/Dan-Bernstein-Qmail.html" target="_blank">people will still find ways</a> to break your software. Be humble and accept them, they're one of the costs of writing software. The only thing that should be on your mind when you receive a security report is protecting your users. The rest is just ego and fear of failure.</p>
<p>So, be open, talk to security researchers, and make it easy for them to contact you (<strong>tips: create a page dedicated to security on your website, and provide a specific email for that</strong>).</p>
<h2>Damage control of a public vulnerability</h2>
<p>What do you do when you discover the weakness on the news/twitter/whatever?</p>
<p>Communicate. Now.</p>
<p>Contact the researchers, contact the journalists writing about it, the users whining about the issue, write on your blog, on twitter, on facebook, on IRC, and tell them this: "<strong>we know about the issue, we're looking into it, we're doing everything we can to fix it, and we'll update you as soon as it's fixed</strong>".</p>
<p>This will buy you a few hours or days to fix the issue. You can't say anything else, because you probably don't know enough about the problem to formulate the right opinion. <strong>What you should not say</strong>:</p>
<ul>
<li>"we've seen no report of this exploited in the wild", yet</li>
<li>"as far as we know, the bug is not exploitable", but soon it will be</li>
<li>"the issue happens on a test server, not in production" = "we assume that the researcher didn't also test on prod servers"</li>
<li>"no worries, there's a warning on our website telling that it's beta software". Beta means people are using it.</li>
</ul>
<p>Anything you could say in the few days you got might harm your project. Take it as an opportunity to cool your head, work on the vulnerability, test regressions, find other mitigations, and plan the new release.</p>
<p>Once it is done, publish the security report:</p>
<h2>Warning your users</h2>
<p>So, now, you fixed the vulnerability. You have to tell your users about it. As time passes, more and more people will learn about the issue, so they might as well get it from you.</p>
<p><strong>You should have a <a title="VideoLAN security information" href="http://www.videolan.org/security/" target="_blank">specific webpage for security issues</a></strong>. You may fear that criminals might use it to attack your software or website. Don't worry, they don't need it, they have other ways to know about software weaknesses. This webpage is for your users. It has multiple purposes:</p>
<ul>
<li>showing that you handle security issues</li>
<li>telling which versions someone should not use</li>
<li>explaining how to fix some vulnerabilities if people cannot update</li>
</ul>
<p>For each vulnerability, here is what you should display:</p>
<ul>
<li>the title (probably chosen by the researcher)</li>
<li>the security researcher's name</li>
<li>the <a title="Common Vulnerabilities and Exposures" href="http://cve.mitre.org/" target="_blank">CVE identifier</a></li>
<li>the chain of events:
<ul>
<li>day of report</li>
<li>dates of back and forth emails with the researcher</li>
<li>day of fix</li>
<li>day of release (for software)</li>
<li>day of deploy (for web apps)</li>
</ul>
</li>
<li><strong>the affected versions</strong> (for software, not web apps)</li>
<li>t<strong>he affected components</strong> (maybe the issue only concerns specific parts of a library)</li>
<li>how it can be exploited. You don't need to get into the details of the exploit.</li>
<li><strong>The target of the exploit.</strong> Be very exhaustive about the consequences. Does the attacker get access to my contacts list? Can he run code on my computer? etc.</li>
<li><strong>The mitigations</strong>. Telling to update to the latest version is not enough. Some users will not update right away, because they have their own constraints. Maybe they have a huge user base and can't update quickly. Maybe they rely on an old feature removed in the latest version. Maybe their users refuse to update because it could introduce regressions. What you should tell:
<ul>
<li>which version is safe (new versions with the fix, but also old versions if the issue was introduced recently)</li>
<li>if it's open source, which commit introduced the fix. That way, people managing their own internal versions of software can fix it quickly</li>
<li>how to fix the issue without updating (<a href="http://www.reddit.com/r/netsec/comments/13664q/skype_vulnerability_allowing_hijacking_of_any/c715m20" target="_blank">example for a recent Skype bug</a>). You can provide a quick fix, that will buy time for sysadmins and downstream developers to test, fix and deploy the new version.</li>
</ul>
</li>
</ul>
<p>Now that you have a good security report, contact again the security researchers, journalists and users, provide them with the report, and emphasize what users risked, and how they can fix it. You can now comment publicly about the issue, make a blog post, send emails to your users to tell them how much you worked to protect them. And don't forget the consecrated formule: "we take security very seriously and have taken measures to prevent this issue from happening ever again".</p>
<p><strong>Do you need help fixing your vulnerabilities? <a title="Geoffroy Couprie, freelance in software development and security" href="http://geoffroycouprie.com/" target="_blank">Feel free to contact me!</a></strong></p>
