<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

  <title>
    
      Unhandled Expression &middot; Geoffroy Couprie – software security and architecture consultant
    
  </title>

  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-117988815-1', 'auto');
  ga('send', 'pageview');
  </script>



  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
  

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface" />

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon.png" />
<link rel="shortcut icon" href="/favicon.ico" />

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />

  <!-- Additional head bits without overriding original head -->
</head>


  <body class="index">

    <div id="sidebar">
  <header>
    <img src="https://s.gravatar.com/avatar/ed9901b9b80743c05aedf58b4f4926dd?s=200" alt="self" />
    <h1 class="site-title">
      <a href="/">
        
          <span class="back-arrow icon"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 0h24v24H0z" fill="none"/>
  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
</svg></span>
        
        Unhandled Expression
      </a>
    </h1>
    <p class="lead">Geoffroy Couprie – software security and architecture consultant</p>
  </header>
  <nav id="sidebar-nav-links">
  
    <a class="home-link "
        href="/">Home</a>
  
  

  

  


  
    
  

  
    
      <a class="page-link "
          href="/about.html">About</a>
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  


  


  
    
  

  
    
  

  
    
      <a class="category-link "
          href="/category/architecture.html">Architecture</a>
    
  

  
    
      <a class="category-link "
          href="/category/crypto.html">Crypto</a>
    
  

  
    
      <a class="category-link "
          href="/category/development.html">Development</a>
    
  

  
    
  

  

  
    
      <a class="category-link "
          href="/category/rust.html">Rust</a>
    
  

  
    
  

  
    
      <a class="category-link "
          href="/category/security.html">Security</a>
    
  

  
    
  

  
    
      <a class="category-link "
          href="/category/videolan.html">VideoLAN</a>
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  


  <!-- Optional additional links to insert in sidebar nav -->
</nav>


  <nav id="sidebar-icon-links">
  

  <a id="subscribe-link"
     class="icon" title="Subscribe" aria-label="Subscribe"
     href="/feed.xml">
    <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <circle cx="6.18" cy="17.82" r="2.18"/>
    <path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/>
</svg>
  </a>

  
  
  
  

  
    <a id="tags-link"
       class="icon"
       title="Tags" aria-label="Tags"
       href="/tags.html">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
    </a>
  

  
    <a id="search-link"
       class="icon"
       title="Search" aria-label="Search"
       href="/search.html">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>
    </a>
  

  <!-- Optional additional links to insert for icons links -->
</nav>
  <a class="category-link active" href="https://www.patreon.com/geoffroy">Support my work on Patreon</a>
  <!--<p>
  &copy; 2018.
  <a href="/LICENSE.md">MIT License.</a>
</p>
-->
</div>


    <main class="container">
      <div class="content">
  
<div class="pagination">
  <a class="pagination-item newer"
     href="/page7">
    Newer
  </a>
</div>



  

  
  <article class="post-body">
    <h2 class="post-title">
      <a href="/general/security/2012/08/29/software-security-is-like-medicine.html">
        Software security is like medicine
      </a>
    </h2>
    <div class="post-meta">
  <span class="post-date">29 Aug 2012</span>
  <span class="post-categories">
    
      &bull;

      
      
      

      
        General
      
    
      &bull;

      
      
      

      
        <a href="/category/security.html">
          Security
        </a>
      
    
  </span>
</div>

    
      <p>People don't get software security. Between the legends around hackers, the scaremongering by salesmen and the technical level needed to practice it, you won't even try to understand. It is hard to get a high level view of how it works, and how you can protect yourself. But there's a nice little metaphore to understand security: it's like medicine!</p>
<p>Medicine is about taking care of your body, fighting off illness, healing injuries. The body is a big machine that can fail in a lot of ways, depending on a lot of parameters. It is the same for software security: you want to prevent and repair any disruption that could fail at any time. Security, like medicine, is a very technical domain, and takes a lot of time to learn. Even after learning, you still don't know everything, and you must keep up to date with recent research.</p>
<p>But basic body maintenance is easy. And protecting your software against basic attacks is easy too. You don't need to study for 11 years to prevent basic SQL injections. Most of the time, the diseases and bugs that will affect you are common, and you don't need Dr House to prevent them.</p>
<p>Bodies and software are problematic because they both decay through time, and are very sensitive to their environment. Change the environment, and you could catch something new. The world is full of germs and criminals. Is that a good reason to always stay at home? Obviously not. You must accept that you can get sick at any time. So, take steps to protect yourself. Wash your hands and sanitize your inputs. And beware of snake oil.</p>
<p>Feel free to extend on the metaphore in the comments, and use it to explain software security around you!</p>
<p>By the way, if you need someone to auscultate your applications, you can contact me at <a title="Geoffroy Couprie" href="http://geoffroycouprie.com/" target="_blank">geoffroycouprie.com</a>. <a href="http://geoffroycouprie.com/"><br />
</a></p>

    

    
      
      
      

      
    
  </article>
  
  <article class="post-body">
    <h2 class="post-title">
      <a href="/general/2012/08/23/hiring-gurus.html">
        Hiring gurus
      </a>
    </h2>
    <div class="post-meta">
  <span class="post-date">23 Aug 2012</span>
  <span class="post-categories">
    
      &bull;

      
      
      

      
        General
      
    
  </span>
</div>

    
      <p>I see a lot of posts on job boards asking for "gurus", ninjas" or whatever. That is ridiculous at best, dangerous at worst.</p>
<p>Ridiculous, because you won't find gurus on job boards. The real stars will not look for a job on these websites. They stay in companies that know their value and pay them well. Or they are directly contacted with offers tailored to them. They don't need job boards.</p>
<p>That is also dangerous, because you will gather good or average developers with a very high idea of themselves. They think of themselves as awesome developers, so why would they learn anything? For your teams, you need team players, humble people, able to recognize their errors, and able to learn. You don't need a lonesome cowboy.</p>
<p>Even worse, you will refuse future gurus because they're not good enough right now. Some developers have a lot of potential, and can bloom in the right environment. Think of it: a developer cheaper than others who will deliver more than others in a year! You will also refuse useful people: an bad developer with a knack for debugging, a bad developer with a lot of knowledge about low level problems, a bad developer who will boost your team's productivity, just because he's good with people...</p>
<p>These job posts reinforce the cargo cult of the awesome geek wrangling tons of awesome code without sleep and with a lot of coffee. Enough with that! We geeks are not produced in chain, with A, B, or C quality level. We are real people, with unique qualities or defects, and you will miss out on awesome people while you wait for your prince charming.</p>

    

    
      
      
      

      
    
  </article>
  
  <article class="post-body">
    <h2 class="post-title">
      <a href="/security/2012/06/13/your-data-is-precious.html">
        Your data is precious
      </a>
    </h2>
    <div class="post-meta">
  <span class="post-date">13 Jun 2012</span>
  <span class="post-categories">
    
      &bull;

      
      
      

      
        <a href="/category/security.html">
          Security
        </a>
      
    
  </span>
</div>

    
      <p>Following LinkedIn's large password leak, I have seen a dangerous thought spread to friends and colleagues:<br />
"so what if my LinkedIn password has leaked? What can they do? Look for a job for me?"</p>
<p>That is based on wrong assumptions about what an attacker wants and can do. And it is mistaking the low value you get from a service with the value of your data. Your data is PRECIOUS. Maybe not to you. But everything can be sold, and you'll always find someone interested to buy it. Let's see a few creative uses of your Linkedin account:</p>
<h2>Analyze your data</h2>
<p>You might think that what you share is of no use to anyone except potential recruiters, but by mixing your resume, shared links, private messages, all the data you put on the website, I could build a nice profile and sell it to advertisers. Did you put your address and phone number somewhere in your profile? Awesome! I have a lot of targeted advertisements for you!</p>
<h2>Obtain access to your other accounts(email, Facebook, Twitter, Viadeo...)</h2>
<p>With your email address and your password, I could probably guess the password for other services. Almost nobody has strong and different passwords for every service. Would you like to see your Facebook or Twitter account compromised? I don't think so.</p>
<p>Oh, remember to use a strong password, or even two factor authenticatiob for email. A lot of password recovery systems sues emails, so if your mailbox is compromised, your accounts will be compromised.</p>
<h2>Spam/SEO</h2>
<p>Nothing ca be done with your account? oh, you have contacts. And maybe, a well referenced profile. I'd be able to send spam links to all your contacts with the user feed, and put them in your profile, to improve the ranking of my websites. Sure, there's no harm to you, if you don't care about losing credibility or annoying your contacts.</p>
<h2>Using the contact list</h2>
<p>Oh, yes, I could sell your contact list, that's easy money!</p>
<p>While I'm at it, I could have fun with your friends and colleagues:</p>
<ul>
<li>ask them for money, nude pictures, confidential information, etc.</li>
<li>tell them that your email account has been compromised, and that they must address their emails to another address controlled by me</li>
<li>obtain access to their accounts with social engineering</li>
</ul>
<div>You may be insignificant, but that's not necessary true of your contacts. <strong>In social networks, your network has a value, and you must protect it</strong>. It is your responsibility to make sure your friends and colleagues don't get compromised through your account.</div>
<div>It reminds me of the 90s, when I often had this dialogue:</div>
<div>Me-You should put an antivirus and firewall on your computer.</div>
<div>You-Why should I? There's nothing interesting on my computer, why would anyone want to infect it?</div>
<div>Me-I receive from you 10 emails a day, and all of them contain a virus."</div>
<div></div>

    

    
      
      
      

      
    
  </article>
  
  <article class="post-body">
    <h2 class="post-title">
      <a href="/development/security/2012/01/05/worst-case-messaging-protocol.html">
        Worst Case Messaging Protocol
      </a>
    </h2>
    <div class="post-meta">
  <span class="post-date">05 Jan 2012</span>
  <span class="post-categories">
    
      &bull;

      
      
      

      
        <a href="/category/development.html">
          Development
        </a>
      
    
      &bull;

      
      
      

      
        <a href="/category/security.html">
          Security
        </a>
      
    
  </span>
</div>

    
      <p>We already have lots of tools to communicate safely, and in some cases, anonymously. These tools work well for their purpose, but spying and law enforcement tools have also improved.</p>
<p>People are forced to decrypt their hard drives in airports. Rootkits are developed by police forces. DPI systems are installed on a country level. Using the graph of who communicates with whom, it is possible to map the whole hierarchy of an organisation, even if all communications are encrypted. How can we defend against that?</p>
<p>I believe that the analysis of organisations is one of the biggest threats right now. The ability to recognize an organization is the ability to destroy it by seizing a few members. That may be useful against terrorists, but these tools are too powerful, and they may be used by the wrong hands. Terrorists already know how to defend against such systems, but what of common people? Any company, association or union could be broken anytime.</p>
<p>I think we need tools to mount resilient organizations. A compromised node shouldn't bring down the whole system. Intercepted messages shouldn't give too much information on the different parties. People can still find ways to send their messages safely (PGP, dead drops, giving USB keys hand to hand), but we need a framework to build decentralized human systems.</p>
<p>Here is the solution I propose: a messaging protocol designed to protect identities and route around interception. This protocol is designed to work in the worst case (hence its name), when any communication could be intercepted, and even when we can only use offline communication.</p>
<p>Every message is encrypted, signed and nearly anonymized (if you already know the emitter or receiver, you can recognize their presence, but this can be mitigated). To introduce redundant routes in the network, a simple broadcast is used (the protocol is not designed for IP networks, but for human networks, with limited P2P communication). Any node can be used to transmit all the messages. The fundamental idea is that if you're compromised, the whole organization can still work safely without you.</p>
<h2>Prerequisites</h2>
<h3>Assumptions</h3>
<ul>
<li>Every communication can be intercepted</li>
<li>if a node is compromised, every message it can read or write is compromised</li>
<li>People can still create a P2P (IRL) network to communicate (aka giving an USB key to someone else)</li>
</ul>
<h3>Goals</h3>
<ul>
<li>Confidentiality</li>
<li>Anonymity</li>
<li>Authentication</li>
<li>Deniability? (I am just a messenger)</li>
<li>Untraceability</li>
<li>Can work offline (worst case)</li>
</ul>
<p>For this protocol, we need a RNG, a HMAC function, a symmetric cipher and an asymmetric cipher. I have not yet decided what algorithms must be used. They could be specified in the message format, to permit future changes in algorithms.</p>
<h2>Message format</h2>
<ul>
<li>nonce1</li>
<li>HMAC( sender's public key, nonce1 )</li>
<li>expiration date</li>
<li>symcrypt( symmetric key, message )</li>
<li>nonce2</li>
<li>For each receiver:
<ul>
<li>asymcrypt( receiver1's public key, symmetric key )</li>
<li>HMAC( receiver1's public key, nonce2 )</li>
<li>asymcrypt( receiver2's public key, symmetric key )</li>
<li>HMAC( receiver2's public key, nonce2 )</li>
</ul>
</li>
<li>asymsign( sender's private key, whole message )</li>
</ul>
<p>Here is how it works:<br />
An identity is represented by one or more public keys (you can have a different public key for each of your contacts, it makes messages difficult to link to one person). They are not publicly linked to a name or email address, but the software layer could handle the complexity with a good enough UI. I do not cover key exchange: users must design their own way to meet or establish communications.</p>
<p>Every user is a hub: all messages are broadcasted by all users. To prevent data explosion, expiration dates are used. Users recognize the message they receive and the identity of the emitter, using the HMAC of the public keys. All communication are encrypted, but I use the convergent encryption ideas to have multirecipient messages.</p>
<h2>Handling the messages</h2>
<h3>Parsing</h3>
<ul>
<li>verify if one of my public keys is in the receivers by calculating the HMAC with nonce2</li>
<li>validate the signature (if I already know the emitter's public key)</li>
<li>decrypt the symmetric key that was encrypted with my public key</li>
<li>decrypt the message</li>
</ul>
<h3>Creating messages</h3>
<ul>
<li>write the message</li>
<li>choose the emitter's identity and public key</li>
<li>choose the receivers and the public keys used</li>
<li>choose an expiration date</li>
<li>generate two random nonces</li>
<li>generate a symmetric key</li>
<li>insert nonce 1 and the HMAC of nonce 1 and my key</li>
<li>insert the expiration date</li>
<li>encrypt the message with the symmetric key and insert it</li>
<li>insert nonce 2</li>
<li>for each receiver:
<ul>
<li>encrypt the symmetric key with the receiver's public key and insert the result</li>
<li>insert the HMAC of nonce 2 and the receiver's public key</li>
</ul>
</li>
<li>sign the whole message with my private key and append the signature</li>
</ul>
<h3>Sending messages</h3>
<ul>
<li>Take all the messages you received</li>
<li>filter them according to some rules:
<ul>
<li>remove expired messages</li>
<li>remove messages too large?</li>
<li>etc</li>
</ul>
</li>
<li>add your messages to the list</li>
<li>give the message list to the next node in the network</li>
</ul>
<p>This protocol is voluntarily simple and extensible. New techniques can be devised based on this protocol, like dummy receivers in a message or dummy messages to complicate analysis. It is independent of the type of data transmitted, so any type of client could use this protocol (it is at the same level as IP). Most of the logic will be in the client and the contact manager, to present an interface easy to use.</p>
<p>I truly hope we will never need this to communicate, but recent events have convinced me that I need to release it, just in case.</p>
<p>I am open to any critique or suggestion about this protocol. I will soon open a repository to host some code implementing it, and it will of course be open to contributions :)</p>

    

    
      
      
      

      
    
  </article>
  
  <article class="post-body">
    <h2 class="post-title">
      <a href="/general/reinventing%20the%20wheel/security/web/2011/11/18/how-to-get-a-certificate-signed-by-multiple-certification-authorities.html">
        How to get a certificate signed by multiple certification authorities
      </a>
    </h2>
    <div class="post-meta">
  <span class="post-date">18 Nov 2011</span>
  <span class="post-categories">
    
      &bull;

      
      
      

      
        General
      
    
      &bull;

      
      
      

      
        Reinventing the wheel
      
    
      &bull;

      
      
      

      
        <a href="/category/security.html">
          Security
        </a>
      
    
      &bull;

      
      
      

      
        Web
      
    
  </span>
</div>

    
      <p>Sort of. Here is a way to do it, but I don't a practical use for this hack right now. But it is fun anyway :)</p>
<h2>Here we go!</h2>
<p>I was thinking about ways to distribute trust, and played a bit with CA generation and OpenSSL, when it occured to me: it depends more on a key pair than on a certificate! If I consider that I trust a key instead of a certificate, I begin to see a way (certificates are only restrictions on the trust between keys).</p>
<p>It is really easy to get multiple certification authorities to sign a certificate for the same key (even for the same subject name in some cases). You send the certificate signing request to two certificate authorities, and you get two certificates, for the same keys and same subject names. But the issuer, dates, serial and signature are different. That's why a certificate has only one certification chain.</p>
<p>But what will happen if I delegates the certification to another key? Here is the idea:</p>
<ul>
<li>create a first key pair</li>
<li>create a CSR for this key pair, and add the certification authority extension</li>
<li>ask the certification authorities to sign this CSR</li>
<li>you now have multiple certificates, for one key pair, all of them with the same subject name, and with certification authority powers</li>
<li>create a second key pair</li>
<li>create a CSR for this key pair, with a subject name for your email/domain name/organisation/whatever</li>
<li>sign this CSR with the first key pair, and any of the CA certificates you obtained before</li>
</ul>
<p>You are now the proud owner of a valid certificate for your domain name, with multiple certification chains going up to each of the root CAs. Why? The issuer's subject name and public key is the same for all of the generated CAs, and they're included in the end certificate. Any generated CA certificate can be used to verify that signature, and all the certification paths will work. Cool, huh?</p>
<h2>Okay, but...</h2>
<ul>
<li>Creating a sub CA is very expensive (if you want it to be recognized by all the browsers)</li>
<li>good luck with creating multiple sub CA and getting away with it</li>
<li>Assuming that certification authorities accept it, the sub CA private key could be thrown away after signing the certificate. But who will create and delete the subCA key? you, one of the CAs?</li>
<li>In the case of TLS, serving all the certification chains will have no impact: the browsers take the first matching sub CA in the list for the verification, they will not retry with another sub CA if they don't find a root (but if you serve one certification chain at a time, it will work).</li>
</ul>
<p>See, I said "no practical use" :)</p>

    

    
      
      
      

      
    
  </article>
  

  
<div class="pagination">
  <a class="pagination-item older"
     href="/page9">
    Older
  </a>
</div>


</div>
    </main>

    <!-- Optional footer content -->

  </body>
</html>
